# Configuration for Yandex DataSphere Job
# This file defines the environment, inputs, outputs, and commands for the training and prediction pipeline.

# --- Job Metadata ---
name: plastinka-sales-prediction-job
desc: Trains a TiDE model, generates sales predictions, and saves the model and metrics.

# --- Compute Resources ---
# Define the resources and VM configuration for the job.
# Replace <instance-type> with an appropriate instance type from Yandex Cloud.
# Example: 'g1.1' for a standard CPU instance, or 'g2.8' for a GPU instance.
cloud_instance_types:
  - <instance-type> # e.g., g1.1


# --- Job Inputs ---
# These files will be uploaded and made available inside the job's environment in the /project/inputs/ directory.
# The .dill and .json files must exist at the specified paths relative to the project root
# when you run `datasphere project job execute`.
# inputs: 

# --- Job Outputs ---
# These files will be generated by the script in /project/outputs/ and collected by DataSphere.
outputs:
  - output.zip: OUTPUT

# --- Environment Configuration ---
env:
  python:
    # Use manual configuration with local-paths for precise control
    type: manual
    # Specify the Python version. Should match the one used in development.
    version: '3.10'
    # Include only the main package source code
    local-paths:
      - plastinka_sales_predictor/  # Main package source code only
    # Specify the requirements file. It will be installed via pip from the inputs.
    requirements-file: requirements.txt

# --- Execution Command ---
# The main command to execute in the job. Simplified without wheel installation.
cmd: python plastinka_sales_predictor/datasphere_job/train_and_predict.py \
    --input ${INPUT} \
    --output ${OUTPUT}